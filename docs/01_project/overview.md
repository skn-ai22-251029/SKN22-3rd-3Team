# ğŸ° ZIPSA: AI-Powered Cat Head Butler Service
> **"Every Butler Needs a Head Butler."**
> **Agentic RAG-based Lifestyle Matching & Comprehensive Care System**

---

## 1. Project Vision (ë¹„ì „)
**ZIPSA(ì§‘ì‚¬)**ëŠ” ì´ˆë³´ ë° ì˜ˆë¹„ 'ì§‘ì‚¬(ê³ ì–‘ì´ ë°˜ë ¤ì¸)'ë¥¼ ìœ„í•œ **AI ìˆ˜ì„ ì§‘ì‚¬ ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤.
ì‚¬ìš©ìì˜ ë¼ì´í”„ìŠ¤íƒ€ì¼ì„ ì‹¬ì¸µ ë¶„ì„í•˜ì—¬ ê°€ì¥ ì í•©í•œ ë¬˜ì¢…ì„ ì¶”ì²œí•˜ê³ (Matching), ì…ì–‘ ì ˆì°¨ë¥¼ ì•ˆë‚´í•˜ë©°(Liaison), ì…ì–‘ í›„ì—ëŠ” ë‹¤ì¤‘ë¬˜ ê°ˆë“± ì¡°ì •ë¶€í„° ê±´ê°• ê´€ë¦¬ê¹Œì§€(Care) ì „ë°©ìœ„ë¡œ ì§€ì›í•˜ëŠ” **'Agentic RAG' ê¸°ë°˜ì˜ ì½”ì¹­ ì‹œìŠ¤í…œ**ì…ë‹ˆë‹¤. ë‹¨ìˆœí•œ ì±—ë´‡ì„ ë„˜ì–´, ì „ë¬¸ì„±ì„ ê°€ì§„ **ì „ë¬¸ê°€ íŒ€(Specialist Agents)**ì´ í˜‘ì—…í•˜ì—¬ ì‚¬ìš©ìì˜ ê³ ë¯¼ì„ í•´ê²°í•©ë‹ˆë‹¤.

---

## 2. Core Features (í•µì‹¬ ê¸°ëŠ¥)

### ğŸ§© 1. Lifestyle Matching (ë§ì¶¤í˜• ë§¤ì¹­)
- **ì‚¬ìš©ì ë¶„ì„**: ì£¼ê±° í™˜ê²½(ì•„íŒŒíŠ¸/ì£¼íƒ), ê°€ì¡± êµ¬ì„±ì›, ì•ŒëŸ¬ì§€ ìœ ë¬´, í™œë™ëŸ‰ ë“±ì„ ê³ ë ¤í•œ ì •ë°€ ë¶„ì„.
- **RAG ê¸°ë°˜ ì¶”ì²œ**: 67ì¢…ì˜ ê³ ì–‘ì´ í’ˆì¢… ë°ì´í„°ì™€ ìˆ˜ì²œ ê±´ì˜ ì–‘ìœ¡ ê°€ì´ë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìµœì ì˜ ë¬˜ì¢… ë§¤ì¹­.
- **Breed Filtering Policy**: "í„¸ ë¹ ì§", "í™œë™ëŸ‰" ë“± ì‚¬ìš©ìì˜ êµ¬ì²´ì ì¸ ìš”êµ¬ì‚¬í•­ì„ ë°ì´í„° ìˆ˜ì¹˜ì™€ ë§¤ì¹­í•˜ëŠ” ì—„ê²©í•œ í•„í„°ë§ ì •ì±…(`breed_criteria.py`) ì ìš©.
- **íŒŒì–‘ ë°©ì§€**: ë‹¨ìˆœ ì™¸ëª¨ê°€ ì•„ë‹Œ, 'í•¨ê»˜ ì‚´ ìˆ˜ ìˆëŠ”' ë°˜ë ¤ë¬˜ë¥¼ ì¶”ì²œí•˜ì—¬ íŒŒì–‘ë¥ ì„ ë‚®ì¶¥ë‹ˆë‹¤.

### ğŸ”­ 2. Ethical Adoption (ì…ì–‘/êµ¬ì¡° ì—°ê³„)
- **ì…ì–‘ ì•ˆë‚´**: ì…ì–‘ ì ˆì°¨, ì„œë¥˜, ë¹„ìš©, ì¤€ë¹„ë¬¼ ë“± ì¼ë°˜ ì…ì–‘ ì •ë³´ë¥¼ RAG ê¸°ë°˜ìœ¼ë¡œ ì œê³µ.
- **êµ¬ì¡°ë™ë¬¼ ì¡°íšŒ**: êµ­ê°€ë™ë¬¼ë³´í˜¸ì •ë³´ì‹œìŠ¤í…œ APIë¥¼ í†µí•´ ë³´í˜¸ ì¤‘ì¸ ê³ ì–‘ì´ ì •ë³´ë¥¼ ì‹¤ì‹œê°„ ì¡°íšŒ.
- **ë³´í˜¸ì†Œ ì—°ê³„**: ì§€ì—­ë³„ ë³´í˜¸ì†Œ ì •ë³´ ë° ì—°ë½ì²˜ ì•ˆë‚´.

### âš–ï¸ 3. Conflict Resolution (ë‹¤ë¬˜ ê°ˆë“± ì¡°ì •)
- **ì„±í–¥ ë¶„ì„**: ê¸°ì¡´ ë°˜ë ¤ë¬˜ì™€ ìƒˆë¡œìš´ ë°˜ë ¤ë¬˜ì˜ MBTI(ì„±ê²© ìœ í˜•) ë¶„ì„.
- **í•©ì‚¬ ì†”ë£¨ì…˜**: ë‹¨ê³„ë³„ í•©ì‚¬ ìŠ¤ì¼€ì¤„ë§ ë° ê¸´ì¥ ì™„í™”(Peacekeeping) í”„ë¡œí† ì½œ ì œê³µ.

### ğŸ©º 4. Lifecycle Care (ìƒì• ì£¼ê¸° ì¼€ì–´)
- **ê±´ê°• ëª¨ë‹ˆí„°ë§**: êµ¬í† , ë°°ë³€ ë“± ì´ìƒ ì§•í›„ ë°œìƒ ì‹œ ì´ˆê¸° ëŒ€ì‘ ê°€ì´ë“œ(Triage) ì œê³µ.
- **ì˜ì–‘ ê´€ë¦¬**: ì—°ë ¹ë³„/ë¬˜ì¢…ë³„ ì‚¬ë£Œ ë° ì˜ì–‘í•™ì  ì¡°ì–¸.

---

## 3. Agent Structure (AI ì—ì´ì „íŠ¸ êµ¬ì¡°)
ZIPSA ì‹œìŠ¤í…œì€ **ìˆ˜ì„ ì§‘ì‚¬(Head Butler)**ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ 4ê°œì˜ ì „ë¬¸ê°€ ë…¸ë“œë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
Head Butlerê°€ ìœ ì¼í•œ Exit Pointì´ë©°, ì „ë¬¸ê°€ ë…¸ë“œëŠ” êµ¬ì¡°í™” JSON(`specialist_result`)ìœ¼ë¡œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ê³  ë°˜ë“œì‹œ Head Butlerë¡œ ë³µê·€í•©ë‹ˆë‹¤.

### ğŸ© Head Butler (ìˆ˜ì„ ì§‘ì‚¬ / Router & Exit Point)
- **ì—­í• **: ì‚¬ìš©ì ì˜ë„ë¥¼ LLM Structured Outputìœ¼ë¡œ ë¶„ë¥˜(`matchmaker`, `liaison`, `care`, `general`)í•˜ì—¬ ë¼ìš°íŒ…. ì¼ë°˜ ì§ˆë¬¸ì€ ì§ì ‘ ì‘ë‹µ. ì „ë¬¸ê°€ ë³µê·€ ì‹œ specialist_resultë¥¼ í›„ì²˜ë¦¬í•˜ì—¬ ìµœì¢… ì‘ë‹µ ìƒì„±.
- **ìœ„ì¹˜**: `src/agents/head_butler.py`

### ğŸ§© Matchmaker (í’ˆì¢… ì¶”ì²œ ì „ë¬¸ê°€)
- **ì—­í• **: ë¼ì´í”„ìŠ¤íƒ€ì¼ ê¸°ë°˜ í’ˆì¢… ì¶”ì²œ (RAG: `specialist="Matchmaker"`, `categories="Breeds"` í•„í„°).
- **ìœ„ì¹˜**: `src/agents/matchmaker.py`

### ğŸ”­ Liaison (ì…ì–‘/êµ¬ì¡° ì „ë¬¸ê°€)
- **ì—­í• **: ì…ì–‘ ì ˆì°¨/ì„œë¥˜/ë¹„ìš© ì•ˆë‚´ (RAG: `specialist="Liaison"`), êµ¬ì¡°ë™ë¬¼ ì¡°íšŒ (Tool).
- **Tool**: `search_abandoned_animals` â€” êµ­ê°€ë™ë¬¼ë³´í˜¸ì •ë³´ì‹œìŠ¤í…œ ìœ ê¸°ë™ë¬¼ ì¡°íšŒ API (`src/agents/tools/animal_protection.py`)
- **ìœ„ì¹˜**: `src/agents/liaison.py`

### ğŸ¥ Care Team (ê±´ê°• & í–‰ë™ í†µí•© ì „ë¬¸ê°€)
- **ì—­í• **: LLM ë¶„ë¥˜ë¡œ Physician(ì˜ë£Œ) / Peacekeeper(í–‰ë™)ì„ ë‚´ë¶€ íŒë‹¨ í›„ í•´ë‹¹ specialist íƒœê·¸ë¡œ RAG ê²€ìƒ‰. í˜ë¥´ì†Œë‚˜ í”„ë¡¬í”„íŠ¸ ê¸°ë°˜ ì‘ë‹µ ìƒì„±.
- **ìœ„ì¹˜**: `src/agents/care_team.py`

> [!TIP]
> ê° í˜ë¥´ì†Œë‚˜ì˜ ìƒì„¸ ì—­í• ê³¼ ë™ì‘ ë°©ì‹ì€ **[personas.md](./personas.md)** ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

---

## 4. Technical Architecture (ì•„í‚¤í…ì²˜)
ë³¸ í”„ë¡œì íŠ¸ëŠ” **LangGraph ê¸°ë°˜ 4-Node Agent System** íŒ¨í„´ì„ ì±„íƒí–ˆìŠµë‹ˆë‹¤.

- **Orchestration**: `LangGraph`ë¥¼ ì´ìš©í•œ ìƒíƒœ ê´€ë¦¬(Stateful) ë° ì—ì´ì „íŠ¸ ë¼ìš°íŒ…. Head Butlerê°€ ìœ ì¼í•œ Exit Point.
- **Knowledge Base (RAG)**:
    - **Vector Store**: MongoDB Atlas Vector Search (`cat_library`).
    - **Retrieval**: Hybrid Search (Vector + Keyword/BM25 + RRF Re-ranking + Dynamic Metadata Filtering).
    - **Data Source**: TheCatAPI(í’ˆì¢…), Wikipedia(ìƒì„¸), BemyPet(ì¼€ì–´ ê°€ì´ë“œ).
- **Interface**: Streamlit ê¸°ë°˜ì˜ ì¸í„°ë™í‹°ë¸Œ ì±„íŒ… UI.
- **Environment**: Python 3.11+ (Conda `skn-third-proj`).
- **Data Pipeline**:
  - **V3 Pipeline**: `src/pipelines/v3/` (Decoupled 3-Stage Process)
    1. **Preprocessor**: Text Cleaning & Tokenization -> `processed.json`
    2. **Embedder**: OpenAI Embedding Generation -> `embedded.pkl`
    3. **Loader**: MongoDB Ingestion (`cat_library`)

> [!IMPORTANT]
> ì‹œìŠ¤í…œì˜ ì‹œê°ì  êµ¬ì¡°ë„ì™€ ë°ì´í„° íë¦„ì€ **[architecture_graph.md](./architecture_graph.md)**ë¥¼ í™•ì¸í•˜ì„¸ìš”.

---

## 5. Directory Structure
```
skn-third-proj/
â”œâ”€â”€ data/               # Raw & Processed Data
â”œâ”€â”€ docs/               # Documentation
â”œâ”€â”€ scripts/            # Execution Scripts
â”‚   â”œâ”€â”€ v3/             # Article Pipeline (run_preprocess, run_embed, run_load)
â”‚   â””â”€â”€ process_breeds_v3.py  # Breed Data Pipeline (Policy-based)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ agents/         # LangGraph Agents & Routing Logic
â”‚   â”‚   â”œâ”€â”€ filters/    # Metadata Filter Extraction (breed_criteria.py)
â”‚   â”‚   â””â”€â”€ tools/      # Agent Tools (animal_protection.py)
â”‚   â”œâ”€â”€ core/           # Standardized Core (Prompts, DTOs, Tokenizer Config)
â”‚   â”œâ”€â”€ pipelines/      # Data Pipelines (ETL)
â”‚   â”œâ”€â”€ retrieval/      # RAG & Search Logic (hybrid_search.py)
â”‚   â””â”€â”€ utils/          # Generic Utilities
â””â”€â”€ .env                # Environment Variables
```
